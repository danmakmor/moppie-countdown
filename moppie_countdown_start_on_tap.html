<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Moppie Countdown ‚Äî Start on Tap</title>
<style>
  :root{
    --bg1:#0f172a;--bg2:#1e293b;--text:#e2e8f0;--muted:#94a3b8;
    --glass:rgba(255,255,255,.06);--glass-stroke:rgba(255,255,255,.18);
  }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial;
    color:var(--text);
    background:
      radial-gradient(1200px 600px at 10% 10%, #0ea5e9 0%, transparent 50%),
      radial-gradient(1000px 600px at 90% 90%, #84cc16 0%, transparent 60%),
      linear-gradient(180deg, var(--bg1), var(--bg2));
    display:grid;place-items:center;padding:24px}
  .wrap{width:min(980px,100%);display:grid;gap:22px}
  .card{position:relative;border-radius:20px;padding:clamp(20px,4vw,36px);
    background:linear-gradient(180deg,var(--glass),rgba(255,255,255,.02));
    border:1px solid var(--glass-stroke);backdrop-filter:blur(10px);
    box-shadow:0 10px 30px rgba(0,0,0,.35), inset 0 1px 0 rgba(255,255,255,.06)}
  h1{margin:0 0 8px;font-weight:800;line-height:1.05;font-size:clamp(26px,4.5vw,44px)}
  .sub{color:var(--muted);font-size:clamp(14px,2vw,16px);margin-bottom:14px}
  .grid{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:clamp(10px,2.2vw,16px)}
  .unit{background:rgba(255,255,255,.04);border:1px solid var(--glass-stroke);border-radius:16px;
    padding:clamp(16px,3vw,24px);text-align:center;position:relative;overflow:hidden}
  .num{font-variant-numeric:tabular-nums lining-nums;font-weight:800;font-size:clamp(34px,7vw,64px);line-height:1}
  .label{margin-top:8px;color:var(--muted);font-weight:600;letter-spacing:.25px;text-transform:uppercase;font-size:clamp(10px,1.6vw,12px)}
  .ticker{transition:transform .5s cubic-bezier(.2,.8,.2,1),opacity .5s;display:inline-block;min-width:2ch}
  .fade{opacity:.6;transform:translateY(10%)}
  .cta{display:grid;grid-template-columns:1fr auto;align-items:center;gap:14px;margin-top:10px}
  .pill{justify-self:start;display:inline-grid;grid-auto-flow:column;align-items:center;gap:8px;padding:10px 14px;background:rgba(34,211,238,.12);
    border:1px solid rgba(34,211,238,.35);color:#e0f2fe;border-radius:999px;font-weight:600;font-size:14px}
  .love{justify-self:end;border:0;cursor:pointer;border-radius:18px;padding:14px 18px;font-weight:800;font-size:16px;letter-spacing:.3px;color:#062e2e;
    background:linear-gradient(180deg,#a7f3d0,#86efac);box-shadow:0 8px 20px rgba(16,185,129,.35), inset 0 1px 0 rgba(255,255,255,.5);
    transition:transform .08s ease,filter .2s ease}
  .love:active{transform:translateY(1px) scale(.98)}
  .toast{position:fixed;left:50%;bottom:24px;transform:translateX(-50%) translateY(20px);background:#111827;color:#e5e7eb;
    border:1px solid rgba(255,255,255,.15);border-radius:14px;padding:12px 16px;font-weight:700;opacity:0;transition:transform .25s,opacity .25s;z-index:50;white-space:nowrap}
  .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
  .celebrate{display:none;text-align:center;font-size:clamp(20px,4vw,28px);font-weight:800;color:#fef3c7;text-shadow:0 6px 24px rgba(0,0,0,.35);margin-top:6px}
  canvas#confetti{position:fixed;inset:0;pointer-events:none}
  .diag{font-size:12px;color:#9ca3af;margin-top:6px}
  .hint{margin-top:8px;color:#c7d2fe;font-weight:700}
  @media (max-width:640px){.grid{grid-template-columns:repeat(2,1fr)}.cta{grid-template-columns:1fr}.love{justify-self:start}}
</style>
</head>
<body>
<canvas id="confetti"></canvas>
<main class="wrap">
  <section class="card">
    <h1>Countdown to Moppie arriving in South Africa</h1>
    <div class="sub" id="subtitle">Arriving <strong>Friday, 7 November 2025</strong> ‚Äî midnight (Africa/Johannesburg)</div>
    <div class="grid" role="timer" aria-live="polite">
      <div class="unit"><span class="num"><span id="d" class="ticker">--</span></span><div class="label">Days</div></div>
      <div class="unit"><span class="num"><span id="h" class="ticker">--</span></span><div class="label">Hours</div></div>
      <div class="unit"><span class="num"><span id="m" class="ticker">--</span></span><div class="label">Minutes</div></div>
      <div class="unit"><span class="num"><span id="s" class="ticker">--</span></span><div class="label">Seconds</div></div>
    </div>
    <div class="hint">Tap the heart to start the countdown.</div>
    <div id="celebrate" class="celebrate">She‚Äôs here! üéâ</div>
    <div class="cta">
      <div class="pill" aria-hidden="true">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M4 12c0-4.418 3.582-8 8-8s8 3.582 8 8-3.582 8-8 8" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          <path d="M12 6v6l3 3" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Waiting to start
      </div>
      <button id="loveBtn" class="love" type="button" aria-label="Tap to show love">‚ù§Ô∏è Tap me</button>
    </div>
    <div class="diag" id="diag"></div>
  </section>
</main>
<div id="toast" class="toast" role="status" aria-live="polite">Ik hou van jou</div>

<script>
// === TARGET in SAST ===
const TARGET_UTC_ISO = '2025-11-06T22:00:00Z'; // = 2025-11-07 00:00:00 in Africa/Johannesburg
const targetTs = new Date(TARGET_UTC_ISO).getTime();
const tzFormatter = new Intl.DateTimeFormat('en-ZA', { timeZone: 'Africa/Johannesburg', dateStyle: 'full', timeStyle: 'short' });
document.getElementById('subtitle').insertAdjacentHTML('beforeend',
  `<div style="margin-top:6px;color:#9ca3af;font-size:12px">Target (SAST): ${tzFormatter.format(new Date(targetTs))}</div>`);

// Elements
const $d = document.getElementById('d');
const $h = document.getElementById('h');
const $m = document.getElementById('m');
const $s = document.getElementById('s');
const $toast = document.getElementById('toast');
const $celebrate = document.getElementById('celebrate');
const $btn = document.getElementById('loveBtn');
const $pill = document.querySelector('.pill');
const $diag = document.getElementById('diag');

// Confetti
const confetti = (() => {
  const canvas = document.getElementById('confetti');
  const ctx = canvas.getContext('2d');
  let pieces = [], anim;
  function resize(){ canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
  window.addEventListener('resize', resize, { passive:true }); resize();
  function burst(n=200){
    pieces = [];
    for(let i=0;i<n;i++){
      pieces.push({ x:canvas.width/2, y:canvas.height*0.2, vx:(Math.random()-0.5)*6, vy:Math.random()*-3-4,
        g:0.12+Math.random()*0.1, s:5+Math.random()*6, a:Math.random()*Math.PI, w:Math.random()*2+0.5,
        life:160+Math.random()*60, hue:Math.floor(180+Math.random()*150) });
    }
    cancelAnimationFrame(anim); animate();
  }
  function animate(){
    anim = requestAnimationFrame(animate);
    ctx.clearRect(0,0,canvas.width,canvas.height);
    pieces.forEach(p=>{
      p.life -= 1; p.vy += p.g; p.x += p.vx; p.y += p.vy; p.a += p.w;
      ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.a);
      ctx.fillStyle = `hsl(${p.hue} 90% 60%)`; ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s); ctx.restore();
    });
    pieces = pieces.filter(p=>p.life>0 && p.y<canvas.height+20);
    if(!pieces.length) cancelAnimationFrame(anim);
  }
  return { burst };
})();

function pad(n){ return String(n).padStart(2,'0'); }
let prev = {d:null,h:null,m:null,s:null};
function setTicker(el, val, key){
  if(prev[key] === val) return;
  el.classList.add('fade');
  setTimeout(()=>{ el.textContent = val; el.classList.remove('fade'); }, 120);
  prev[key] = val;
}

let timer = null;
let started = false;

function tick(){
  const now = Date.now();
  let diff = Math.max(0, targetTs - now);
  const sec = Math.floor(diff/1000);
  const days = Math.floor(sec/86400);
  const hours = Math.floor((sec%86400)/3600);
  const mins = Math.floor((sec%3600)/60);
  const secs = sec % 60;
  setTicker($d, pad(days), 'd');
  setTicker($h, pad(hours), 'h');
  setTicker($m, pad(mins), 'm');
  setTicker($s, pad(secs), 's');
  if(diff === 0){
    document.getElementById('subtitle').firstChild.textContent = "It's today! üáøüá¶";
    $celebrate.style.display = 'block'; confetti.burst(300); stopCountdown();
  }
  $diag.textContent = `Running ‚Ä¢ ${new Date().toLocaleTimeString()} ‚Ä¢ msLeft=${diff}`;
}

function startCountdown(){
  if(started) return;
  started = true;
  $pill.innerHTML = 'Counting down in real time';
  tick();
  timer = setInterval(tick, 1000);
}

function stopCountdown(){
  if(timer){ clearInterval(timer); timer = null; }
  started = false;
}

function showToast(text){
  $toast.textContent = text; $toast.classList.add('show');
  if(navigator.vibrate){ try{ navigator.vibrate(30); }catch(e){} }
  setTimeout(()=> $toast.classList.remove('show'), 1600);
}

// HEART: start the countdown + message + confetti
$btn.addEventListener('click', ()=>{
  showToast('Ik hou van jou');
  confetti.burst(started ? 120 : 200);
  startCountdown();
}, { passive:true });

// Also allow starting via "L" key (and show love)
document.addEventListener('keydown', (e)=>{
  if(e.key.toLowerCase()==='l'){
    showToast('Ik hou van jou');
    confetti.burst(started ? 120 : 200);
    startCountdown();
  }
});
</script>
</body>
</html>
